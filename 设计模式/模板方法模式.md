# 模板方法模式

## 一：模板方法模式概述

平常大家星期六都要出去浪一波，最关键的必然是美食了，那么正常餐厅步骤：点菜 -> 吃饭 -> 买单， 整个步骤是不变的，但是最关键的区别就在于吃什么。每个人都有不同的喜好。在软件开发中，`某个方法的实现可能需要多个步骤，但是有些步骤可变，有些步骤固定`，所以我们可以通过模板方法模式来应对这种情况。其定义如下：

> **定义一个操作中算法的框架，而将一些步骤延迟到子类中。模板方法模式使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。**

模板方法模式是`基于继承的代码复用技术`，是一种`类行为模式`,在其结构中只存在父类与子类之间的继承关系。通过使用模板方法模式，可以`将一些复杂流程的实现步骤封装在一系列基本方法中`，`在抽象父类中提供一个称之为模板方法的方法来定义这些基本方法的执行次序`，而通过其子类来`覆盖某些步骤`，从而使得相同的算法框架可以有不同的执行结果。模板方法模式提供了一个模板方法来定义算法框架，而某些具体步骤的实现可以在其子类中完成。

---

## 二：模板方法模式结构图

![1546050039292](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\1546050039292.png)

**涉及的角色：**

1. `AbstractClass:`在抽象类中定义了一系列基本操作(PrimitiveOperations)，这些基本操作可以是具体的，也可以是抽象的，每一个基本操作对应算法的一个步骤，在其子类中可以重定义或实现这些步骤。同时，在抽象类中实现了一个模板方法(Template Method)，用于定义一个算法的框架，模板方法不仅可以调用在抽象类中实现的基本方法，也可以调用在抽象类的子类中实现的基本方法，还可以调用其他对象中的方法。
2. `ConcreteClass:`它是抽象类的子类，用于实现在父类中声明的抽象基本操作以完成子类特定算法的步骤，也可以覆盖在父类中已经实现的具体基本操作。

**注意点：**

1. `模板方法定义在抽象类中，并且只能是抽象类，而不可以是接口，因为模板方法是具体方法。`
2. `模板方法中的方法类型大致分为三种：抽象方法、具体方法和钩子方法。`

**钩子方法：**

1. `与具体步骤挂钩，控制步骤是否执行，通常方法名为isXXX`

```java
public abstract class AbstractClass{
    //模板方法
public void TemplateMethod() {
    method1();
    method2();
    //通过钩子方法来确定某步骤是否执行
    if (IsMethod3()) {
        method3();
    }
}
//钩子方法 子类可以覆盖选择是否执行
public bool IsMethod3(){
    // 表示执行
    return true;
}
}

```



----

## 三：模式实战

**抽象方法：**

```java
public abstract class InviteToAMeal {
    // 模板方法
    protected void templateMethod(){
        order();
        eat();
        pay();
    }

    protected abstract void order();
    protected abstract void eat();
    protected abstract void pay();
}
```

**继承的子类：**

```java
public class PersonA extends InviteToAMeal {
    @Override
    protected void order() {
        System.out.println("点虾");
    }

    @Override
    protected void eat() {
        System.out.println("吃虾");
    }

    @Override
    protected void pay() {
        System.out.println("付虾钱");
    }
}
```

**运行结果：**

> 点虾
> 吃虾
> 付虾钱

---

## 四：模板方法总结

**优势：**

1. 可以代码复用，提取类的公共行为，放在父类，通过子类来实现不同的行为。
2. 可通过子类覆盖父类方法，不同子类可以有自己的方法实现。

**缺点：**

1. 每个基本方法的不同实现都要提供子类，如果基本方法很多，类将会很庞大。

**适用场景：**

1. 需要通过子类来决定是否用父类的某个算法。实现子类对父类的反向控制。







